Эмулятор для языка оболочки ОС


Описание проекта

Этот проект представляет собой эмулятор для языка оболочки ОС, работающий в стиле shell в UNIX-подобной системе. Эмулятор запускается из реальной командной строки и предоставляет взаимодействие с виртуальной файловой системой, хранящейся в tar-архиве. Основная задача проекта — создать оболочку, которая максимально близко имитирует работу реального терминала.

Техническое задание (ТЗ)


Разработать эмулятор для языка оболочки ОС. Необходимо сделать работу эмулятора как можно более похожей на сеанс shell в UNIX-подобной ОС. Эмулятор должен запускаться из реальной командной строки, а файл с виртуальной файловой системой не нужно распаковывать у пользователя. Эмулятор принимает образ виртуальной файловой системы в виде файла формата tar. Эмулятор должен работать в режиме CLI.

Ключами командной строки задаются:


Имя пользователя для показа в приглашении к вводу.

Имя компьютера для показа в приглашении к вводу.

Путь к архиву виртуальной файловой системы.

Путь к лог-файлу.


Лог-файл имеет формат JSON и содержит все действия во время последнего сеанса работы с эмулятором. Для каждого действия указаны дата и время. Для каждого действия указан пользователь.

Необходимо поддержать в эмуляторе команды ls, cd и exit, а также следующие команды:

wc — подсчет количества строк, слов и символов в файле.

tac — вывод содержимого файла в обратном порядке.

Все функции эмулятора должны быть покрыты тестами, а для каждой из поддерживаемых команд необходимо написать 3 теста.

Возможности эмулятора

Просмотр содержимого директории (ls) — отображает содержимое текущей директории.

Переход между директориями (cd) — позволяет переходить по структуре виртуальной файловой системы.

Выход из эмулятора (exit) — завершает текущий сеанс эмулятора.

Подсчет строк, слов и символов в файле (wc) — выводит количество строк, слов и символов в указанном файле.

Вывод файла в обратном порядке (tac) — выводит строки файла в обратном порядке.

Таблица команд CLI

| Команда  | Описание                                                           |
|----------|--------------------------------------------------------------------|
| ls       | Отображает содержимое текущей директории.                          |
| cd       | Переход в указанную директорию.                                    |
| exit     | Завершение работы эмулятора.                                       |
| wc       | Подсчет строк, слов и символов в указанном файле.                  |
| tac      | Вывод содержимого файла в обратном порядке (построчно).            |

Логирование

Эмулятор поддерживает логирование всех выполненных команд в формате JSON. Лог-файл сохраняет следующую информацию:

Пользователь, выполнивший команду.

Команда, выполненная пользователем.

Дата и время выполнения команды.


Структура проекта

emulator.py: Основной скрипт эмулятора, реализующий все команды оболочки.

test_emulator.py: Набор тестов, покрывающих все команды эмулятора, для проверки корректности их выполнения.

config.ini: Конфигурационный файл с настройками эмулятора.

log.json: Лог-файл, содержащий историю всех действий пользователя.

startup.sh: Стартовый скрипт, выполняющийся при запуске эмулятора.

vfc_archive_new.tar: Tar-архив, содержащий виртуальную файловую систему, над которой производятся действия.

Тестирование

Для каждой команды были разработаны тесты, которые проверяют корректность выполнения операций. Все тесты находятся в файле test_emulator.py и написаны с использованием библиотеки unittest. Тесты проверяют различные сценарии использования команд ls, cd, wc, tac, а также команду exit для завершения работы эмулятора.

Запуск тестов:
python3 -m unittest test_emulator.py

Пример использования

Запуск эмулятора:
python3 emulator.py --user heragromov --host Heras-MacBook-Pro --fs vfc_archive_new.tar --log log.json

Ввод команд в эмуляторе:
[heragromov@Heras-MacBook-Pro .] $ ls
Contents of directory '.':
vfc

Требования

Python 3.x

Модули: os, tarfile, argparse, json, datetime, unittest

Примеры ввода и вывода:

| Ввод команды         | Ожидаемый вывод                                                                 |
|----------------------|--------------------------------------------------------------------------------|
| ls                   | `Contents of directory '.':`                                                   |
|                      | `vfc`                                                                          |
| cd vfc/bin           | Переход в директорию vfc/bin.                                                  |
| ls                   | `Contents of directory 'vfc/bin':`                                             |
|                      | `usr`                                                                          |
| wc bin/usr/3.txt     | `3 21 124 bin/usr/3.txt`                                                       |
| tac bin/usr/3.txt    | `Этот файл добавлен для расширенного тестирования команд ls, wc и tac.`        |
|                      | `Это вторая строка файла 3.`                                                   |
|                      | `Это первая строка файла 3.`                                                   |
| exit                 | `Exiting emulator.`                                                            |
